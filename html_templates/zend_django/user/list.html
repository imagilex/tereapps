{% extends "zend_django/html/html_struct.html" %}
{% load i18n %}
{% load op_helpers %}

{% block content %}

<script type="text/javascript">
    let url_update = "{% url 'user_update' pk='__recordid__' %}";
    let url_delete = "{% url 'user_delete' pk='__recordid__' %}";
</script>

<div class="btn-group" role="group" aria-label="Acciones">
    {% if perms.auth.add_user %}
    <a data-action="create" href="{% url 'user_create' %}" class="btn btn-outline-secondary" role="button" title="{% crud_label 'create' %}">
        {% crud_icon 'create' %}
    </a>
    {% endif %}
    {% if perms.auth.change_user %}
    <button type="button" onclick="App.update_many()" data-action="update" class="btn btn-outline-secondary"role="button" title="{% crud_label 'update' %}">
            {% crud_icon 'update' %}
    </button>
    {% endif %}
    {% if perms.auth.delete_user %}
    <button type="button" data-action="delete" onclick="App.delete_many()" class="btn btn-outline-secondary"role="button" title="{% crud_label 'delete' %}">
        {% crud_icon 'delete' %}
    </button>
    {% endif %}
</div>

<table id="data-grid-report" class="table table-striped table-sm table-responsive">
    <thead>
        <tr>
            <th></th>
            <th onclick="App.sortDataGridReport(1, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Usuario
            </th>
            <th onclick="App.sortDataGridReport(2, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Nombre
            </th>
            <th onclick="App.sortDataGridReport(3, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Email
            </th>
            <th onclick="App.sortDataGridReport(4, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Teléfono
            </th>
            <th onclick="App.sortDataGridReport(5, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Celular
            </th>
            <th onclick="App.sortDataGridReport(6, 'str')" style="cursor:pointer;">
                <i class="fas fa-sort-down float-right d-none sort-sign-asc"></i>
                <i class="fas fa-sort-up float-right d-none sort-sign-desc"></i>
                Whats App
            </th>
            <th class="text-center">
                <div class="d-inline-block" title="Filtros">
                    <button type="button" class="btn btn-outline-secondary btn-sm" role="button" data-toggle="collapse" data-target="#filter-row" aria-expanded="false" aria-controls="filter-row">
                        <i class="fas fa-filter"></i>
                    </button>
                </div>
            </th>
        </tr>
        <tr id="filter-row" class="collapse">
            <th></th>
            <th>
                <input type="text" class="form-control" id="filter_1" />
            </th>
            <th>
                <input type="text" class="form-control" id="filter_2" />
            </th>
            <th>
                <input type="text" class="form-control" id="filter_3" />
            </th>
            <th>
                <input type="text" class="form-control" id="filter_4" />
            </th>
            <th>
                <input type="text" class="form-control" id="filter_5" />
            </th>
            <th>
                <input type="text" class="form-control" id="filter_6" />
            </th>
            <th>
                <div class="btn-group" role="group" aria-label="Filtros">
                    <button type="button" onclick="App.filterDataGridReport()" class="btn btn-outline-secondary" role="button" title="Filtrar">
                        <i class="fas fa-redo-alt"></i>
                    </button>
                    <button type="button" onclick="App.clearFilterDataGridReport()" class="btn btn-outline-secondary" role="button" title="Limpiar Filtros">
                        <i class="fas fa-ban"></i>
                    </button>
                </div>
            </th>
        </tr>
    </thead>
    <tfoot>
        <tr>
            <th></th>
            <th>Usuario</th>
            <th>Nombre</th>
            <th>Email</th>
            <th>Teléfono</th>
            <th>Celular</th>
            <th>Whats App</th>
            <th></th>
        </tr>
    </tfoot>
    <tbody id="data-tbl">
        {% for reg in data %}
            <tr data-object-id="{{ reg.pk }}">
                <td class="text-center">
                    <input type="checkbox" class="action-on-reg" data-recordid="{{ reg.pk }}" data-toggle="toggle" data-size="xs" data-onstyle="secondary" data-style="ios" data-on=" " data-off=" " />
                </td>
                <td data-rawsortvalue="{{ reg.username|lower }}" data-rawfiltervalue="{{ reg.username|lower }}">
                    <a class="main-col-link" href="{% url 'user_read' pk=reg.pk %}">
                        {{ reg.username }}
                    </a>
                </td>
                <td data-rawsortvalue="{{ reg.get_full_name|lower }}" data-rawfiltervalue="{{ reg.get_full_name|lower }}">
                    <a class="main-col-link" href="{% url 'user_read' pk=reg.pk %}">
                        {{ reg.get_full_name }}
                    </a>
                </td>
                <td data-rawsortvalue="{{ reg.email|lower }}" data-rawfiltervalue="{{ reg.email|lower }}">
                    {% if reg.email %}
                    <a data-action="send_mail" href="mailto:{{ reg.email }}" target="_blank">
                        {% action_icon 'send_mail' %}
                        {{ reg.email }}
                    </a>
                    {% endif %}
                </td>
                <td data-rawsortvalue="{{ reg.profile.telefono|lower }}" data-rawfiltervalue="{{ reg.profile.telefono|lower }}">
                    {% if reg.profile.telefono %}
                    <a data-action="call" href="tel:{{ reg.profile.telefono }}" target="_blank">
                        {% action_icon 'call' %}
                        {{ reg.profile.telefono }}
                    </a>
                    {% endif %}
                </td>
                <td data-rawsortvalue="{{ reg.profile.celular|lower }}" data-rawfiltervalue="{{ reg.profile.celular|lower }}">
                    {% if reg.profile.celular %}
                    <a data-action="call" href="tel:{{ reg.profile.celular }}" target="_blank">
                        {% action_icon 'call' %}
                        {{ reg.profile.celular }}
                    </a>
                    {% endif %}
                </td>
                <td data-rawsortvalue="{{ reg.profile.whatsapp|lower }}" data-rawfiltervalue="{{ reg.profile.whatsapp|lower }}">
                    {% if reg.profile.whatsapp %}
                    <a data-action="send_whatsapp" href="https://api.whatsapp.com/send?phone=52{{ reg.profile.whatsapp }}" target="_blank">
                        {% action_icon 'send_whatsapp' %}
                        {{ reg.profile.whatsapp }}
                    </a>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if perms.auth.reset_password %}
                    <a data-action="reset_password" href="{% url 'user_reset_password' username=reg.username %}" class="btn btn-outline-secondary btn-sm" role="button" title="{% action_label 'reset_password' %}">
                        {% action_icon 'reset_password' %}
                    </a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
